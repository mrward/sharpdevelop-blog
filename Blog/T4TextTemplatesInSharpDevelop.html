<?xml version='1.0'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>

  <head>

    <title>T4 Text Templates in SharpDevleop</title>

    <link href="../Help/css/help.css" rel="stylesheet" type="text/css"/>

  </head>

  <body>

    <p>SharpDevelop 4.1 now has integrated support for 
    <a href="http://msdn.microsoft.com/en-us/library/bb126445.aspx">T4 
    Templates</a>. The 
    <a href="http://mjhutchinson.com/journal/2010/05/03/t4_templates_monodevelop"
    >T4 code generation engine for MonoDevelop</a> has been used to 
    make this feature possible so a big thanks to 
    <a href="http://mjhutchinson.com/">Michael Hutchinson</a> for 
    creating this. Features include:</p>

    <ul>

      <li>Syntax highlighting for T4 templates (.tt and .t4 files).</li>

      <li>Support for TextTemplatingFileGenerator and 
      TextTemplatingFilePreprocessor custom tools.</li>

      <li>T4 template errors shown in Errors window.</li>

    </ul>

    <p>Code completion for T4 templates is not currently supported.</p>

    <h2>Creating a T4 Template</h2>

    <p>Open a project in SharpDevelop, right click the project and 
    select <b>Add</b>, <b>New Item</b>. This will open the <b>New 
    File</b> dialog. There are two T4 templates available, one for C# 
    and one for VB.NET.</p>

    <p><img alt="C# T4 template selected in New File dialog"
     src="Images/CSharpT4TemplateInNewFileDialog.png"/></p>

    <p>Select the appropriate file template, give it a name and click 
    the <b>Create</b> button.</p>

    <p><img alt="New C# T4 template open in text editor."
     src="Images/NewCSharpT4TemplateOpenInTextEditor.png"/></p>

    <p>Now you can edit the T4 template. In the example below we have 
    modified the T4 template so it generates the current date and time 
    when it is saved.</p>

    <pre>&lt;#@ template language=&quot;C#&quot; #&gt; 
&lt;#@ output extension=&quot;.txt&quot; #&gt; 
 
Date and time: &lt;#= DateTime.Now #&gt;</pre>
    <p>When the file is saved a new file will be created. In the 
    <b>Projects</b> window this new file will be a child of the T4 
    template file.</p>

    <p><img alt="File generated from T4 template in Projects window."
     src="Images/FileGeneratedFromT4TemplateInProjectsWindow.png"/></p>

    <p>Opening this file in the text editor shows text generated by the 
    T4 template.</p>

    <p><img alt="File generated from T4 template open in text editor."
     src="Images/FileGeneratedFromT4TemplateOpenInTextEditor.png"/></p>

    <h2>Creating a Preprocessed T4 Template</h2>

    <p>SharpDevelop also supports preprocessed T4 templates. A 
    preprocessed T4 template will create a class which can be used by 
    your application at runtime to generate text. We will take our 
    previous template and convert it to a preprocessed T4 template. To 
    do this select the T4 template file in the <b>Projects</b> window, 
    right click and select <b>Properties</b>. Select the <b>Custom 
    Tool</b> property and change it to be 
    <b>TextTemplatingFilePreprocessor</b>.</p>

    <p>
    <img alt="T4 template custom tool property changed to TextTemplatingFilePreprocessor"
     src="Images/T4TemplateCustomToolPropertyChangedToTextTemplateFilePreprocessor.png"/></p>

    <p>Now when you save the T4 template a file will be generated 
    containing a class.</p>

    <p><img alt="Preprocessed T4 template generated file."
     src="Images/PreprocessedT4TemplateOpenInTextEditor.png"/></p>

    <p>This class can then be used in your application to generate text 
    at runtime. Shown below is a simple example of how this class could 
    be used.</p>

    <pre>using System; 
 
namespace MyProject 
{ 
 class Program 
 { 
  public static void Main(string[] args) 
  { 
   MyTextTemplate template = new MyTextTemplate(); 
   string text = template.TransformText(); 
    
   Console.WriteLine(text); 
   Console.ReadLine(); 
  } 
 } 
}</pre>
    <p>The result of running the above code is shown below.</p>

    <p>
    <img alt="Preprocessed T4 template class output displayed in Console output."
     src="Images/PreprocessedT4TemplateClassOutputDisplayedInConsoleWindow.png"/></p>

    <p>For more information on creating T4 templates take a look at 
    <a href="http://www.olegsych.com/2007/12/text-template-transformation-toolkit/"
    >Oleg Sych&apos;s excellent set of T4 tutorials</a>.</p>

  </body>

</html>

